---
title: "マイクロマウス迷路の自動生成"
date: "2020-03-23T11:51:37+09:00"
categories:
  - "作品紹介"
tags:
  - "マイクロマウス"
thumbnail: "icon.png"
draft: true
---

## 概要

こんにちは．けりです．

マイクロマウスを作るにあたって，
普段は迷路を解くことばかり考えていますが，
ふと迷路づくりについて考えてみました．

しかも，ランダムウォークによる迷路の自動生成を試してみました．

果たしてマイクロマウスっぽい迷路はできるのでしょうか．

<!--more-->

## 迷路生成アルゴリズム

実は，迷路の自動生成アルゴリズムは代表的なものがいくつか存在します．

今回は以下のアルゴリズムを用いて迷路の自動生成を試しました．

1. 棒倒し法
2. 穴掘り法
3. 穴掘り法の独自拡張

## 棒倒し法

迷路上のすべての柱から無作為に棒を倒すように壁を立てる方法によって迷路を作ることができます．

とても簡単なアルゴリズムですが，
すべての柱に少なくともひとつの壁が隣接しているようなマイクロマウス規定に則った迷路が作成できます．

なお，棒を倒すとき既に壁が有る場合は別のところに倒します．

### 自動生成された迷路

棒倒し法によって次のような迷路が自動生成されました．

乱数なので，実行するたびに全く違う迷路が生成されます．

何通りか生成して，
複数のルートが現れるものを選びました．

![迷路](poll_maze_1.png)

![迷路](poll_maze_2.png)

![迷路](poll_maze_3.png)

### ゴール区画の選択

今回の迷路では，
ゴール区画は
スタート区画から行き得る最も遠い区画に設定しました．

具体的には，スタート区画からステップマップを展開した際に一番ステップが大きくなる区画です．

今回は，簡単のためゴールは1マスです．

### 最短経路の種類

区画および壁ベースの歩数最短と，スラロームと台形加速を考慮した斜めありなしの時間最短の経路を表示しています．

| 色       | アルゴリズム                                     |
| -------- | ------------------------------------------------ |
| 青色     | 区画ベースの歩数最短                             |
| マゼンタ | 壁ベースの歩数最短                               |
| 黄色     | スラロームと台形加速を考慮した時間最短(斜めあり) |
| シアン   | スラロームと台形加速を考慮した時間最短(斜めなし) |

### 迷路の考察

あまり複雑な最短経路はできず，だいたい単純な最短経路のみです．

また，封鎖されている区画が多く目立ちます．
運が悪いとスタート区画付近が封鎖されて，つまらない迷路になってしまいます．

このアルゴリズムではあまりいい迷路はできそうにありません．

## 穴掘り法

次に，深さ優先探索の考え方を用いたランダムウォークによる迷路生成アルゴリズムを試しました．

予め迷路内のすべての壁を立てた状態にして，
スタートから壁を消しながらランダムウォークで進んでいく方法です．

具体的には，
先に進む際に現在位置をスタックに保管し，
周囲が既知区画になったらスタックを辿って未知区画に隣接したところまで戻ります．

この迷路の特徴として，閉鎖空間がなくすべてが繋がった迷路となるメリットがあります．  
つまり，迷路上のすべての区画に到達可能となります．

ただし，スタートを根とした木構造になっているので，適当な2点間の経路が必ず一意になるという特徴があります．

マイクロマウスでは複数のルートからマシンにあったルートを選択するところもおもしろいところなので，それができなくなってしまうのはイマイチです．

### 自動生成された迷路

次のような迷路が自動生成されました．

![迷路](dfs_maze_1.png)

![迷路](dfs_maze_2.png)

![迷路](dfs_maze_3.png)

### 迷路の考察

迷路全体を通るスパルタ経路ができがちです．

これが最短経路とはとても思えないくらい長距離の迷路です．

まるで中部地区大会のようですね．

## 深さ優先探索ランダムウォークの独自拡張

![迷路](mydfs_maze_1.png)

![迷路](mydfs_maze_2.png)

![迷路](mydfs_maze_3.png)

乱数でいくつか生成して，複数のルートができたものを掲示しています．

### 難点

袋小路がほとんどできない

## まとめ

今まで競技で出てきた経路は十分短い経路であったことがわかります．

今後はもっと長い経路が出るのでしょうか...

## 参考文献

- http://www5d.biglobe.ne.jp/stssk/maze/make.html
- https://en.wikipedia.org/wiki/Maze_generation_algorithm
